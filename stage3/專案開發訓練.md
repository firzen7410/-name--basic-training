# 專案開發訓練-資料工程師-綜合應用

## 訓練目標

- 工作拆分與時程規劃
- 爬蟲開發
- API 開發
- pytest 測試框架開發
- 靜態網頁渲染練習

## 作答方式

- 題目會提供`功能情境`、`功能需求`，以及`預期產出`，請依照這些基本資訊嘗試進行系統設計，並規劃工作階段與時程
- 請延續使用新人教育訓練的 repository

## 期限

專案開發訓練為期三週

## review 時間點

- 完成系統規劃後，進行開發前review，須包含預期工作項目與時程 (約rd2同仁)
- 各工作時程到期前 (約rd2同仁)
- 完整系統完成時 (約rd2同仁與各部門主管)
- 想確認程式流程，覺得需要code review時 (約rd2同仁)

## 專案情境及需求

- 專案情境
    - 請撰寫一個網站的爬蟲，並將資料庫儲存下來透過撰寫 API 以及簡易的前端頁面進行呈現

- 撰寫需求
    - 爬蟲需每小時定時執行一次，爬蟲目標及欄位請參照下方 [爬蟲目標及要求](#爬蟲目標及要求)
    - 請使用 mariadb 進行資料的儲存，資料庫環境請使用 docker 建立
    - 請撰寫簡易前端頁面，統整爬取到的資料

## 程式架構 (請參考優先順序實作)

1. 請在專案儲存庫當中加入 README.md 描述此專案架構、運作流程、資料格式、如何部屬及執行等
2. 爬蟲程式：每小時爬取新文章，並儲存於資料表中(要能夠長時間執行至少三天)
2. RESTful API：可使用RESTful API介面存取爬到的內容，請利用 FastAPI 進行 RESTful API 的開發，提供使用者查詢資料
3. 測試程式：請利用 pytest 替 CRUD 與爬蟲的部分撰寫測試程式
5. 前端：撰寫簡易前端畫面，結合開發出來的 API 進行資料呈現(Jinja Template)


## 使用套件 (包含但不限於)

請使用以下指定套件開發相應功能：

- 程式語言與套件
    - python 3.11
    - restful API -> [FastAPI](https://fastapi.tiangolo.com/)
    - ORM 架構 -> [SqlAlchemy](https://ithelp.ithome.com.tw/articles/10282664?sc=rss.qu)
    - 資料驗證 -> [Pydantic](https://pydantic-docs.helpmanual.io/)
    - 排程執行 -> [Celery](https://docs.celeryq.dev/en/stable)
    - FastAPI、SQLAlchemy 與 Pydantic 的結合可參考 [這個連結](https://fastapi.tiangolo.com/tutorial/sql-databases/)
    - Jinja、FastAPI的結合可參考 [這個連結](https://fastapi.tiangolo.com/advanced/templates/)

- 資料庫
    - mariadb(要使用關聯)

- 測試程式
    - pytest(單元測試+測試報告)

- 流程圖繪圖工具
    - drawio -> [連結](https://www.diagrams.net/)

- 部屬方式
    - docker-compose

## 爬蟲目標及要求

- 目標網站
    - [PTT](https://www.ptt.cc/bbs/index.html)

- 資料目標
    - 全部。設計資料表，設計後與 mentor 討論資料內容

- 爬蟲要求
    - 挑五個PTT版面，爬取過去一年資料，並定期取得新資料，注意爬文程式物件導向與抽象化
    - 五個版面爬蟲需每小時定時執行一次（celery beat）
    - 爬蟲需要可以穩定執行三天以上 (需有 log 佐證) (log 請存放在資料庫) (Hint：需要在資料庫當中建立資料表儲存)

## Restful API 範例 (包含但不限於)

### 查詢 GET

可藉由api功能查詢爬下來的文章

- `/api/posts` 預設回傳最新的50筆，並且能夠提供分頁（limit, offset），並提供 發文者、更新日期、版面等參數進行查詢
- `/api/posts/<id>` 回傳指定 id 文章詳細資料，id 為資料庫內的 id 非網站上文章 id
- `/api/statistics` 回傳指定條件的統計資訊(文章總數)，並提供時間範圍、版面、作者等參數進行過濾

### 新增 POST

- `/api/posts` 手動建立一筆資料

### 修改 PUT

- `/api/posts/<id>` 手動修改一筆資料

### 刪除 DELETE

- `/api/posts/<id>` 手動刪除一筆資料

## 靜態頁面範例 (包含但不限於)

### 查詢 GET

可藉由api功能查詢爬下來的文章

- `/posts` 預設回傳最新的50筆，並且能夠提供分頁（limit, offset），並提供 發文者、更新日期、版面等參數進行查詢
- `/posts/<id>` 回傳指定 id 文章詳細資料，id 為資料庫內的 id 非網站上文章 id
- `/statistics` 回傳指定條件的統計資訊(文章總數)，並提供時間範圍、版面、作者等參數進行過濾

### 新增 POST

- `/posts` 手動建立一筆資料

### 修改 PUT

- `/posts/<id>` 手動修改一筆資料

### 刪除 DELETE

- `/posts/<id>` 手動刪除一筆資料
